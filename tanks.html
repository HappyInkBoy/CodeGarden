<!DOCTYPE html>
<html>
<body>
    <canvas id="game" width="1345" height="665" style="border:3px solid">
    </canvas>
</body>
<script>
    var c = document.getElementById("game");
    var ctx = c.getContext("2d");
    var VELOCITY = 0.2;
    var VELOCITY_BACK = 0.1;

    var tank1 = {
        x: 75,
        y: 75,
        angle: 0,
        rotation:"none",
        speed: 0,
        color1: "blue",
        color2: "black",
        color3: "gray"
    };

    var tank2 = {
        x: 1270,
        y: 590,
        angle: 0,
        rotation: "none",
        speed: 0,
        color1: "red",
        color2: "black",
        color3: "gray"
    };

    function drawTank(tank, delta) {
        if (tank.rotate == "anticlock") {
            tank.angle -= delta * 0.005;
        }
        if (tank.rotate == "clock") {
            tank.angle += delta * 0.005;
        }
        tank.x = tank.x + tank.speed * delta * Math.cos(tank.angle);
        tank.y = tank.y + tank.speed * delta * Math.sin(tank.angle);

        ctx.translate(tank.x, tank.y);
        ctx.rotate(tank.angle-Math.PI/2);
        ctx.translate(-tank.x, -tank.y);
        
        ctx.fillStyle = tank.color1;
        ctx.fillRect(tank.x - 35 / 2, tank.y - 60 / 2, 35, 60);

        ctx.fillStyle = tank.color2;
        ctx.fillRect(tank.x - 5, tank.y, 10, 40);

        ctx.beginPath();
        ctx.fillStyle = tank.color3;
        ctx.arc(tank.x, tank.y, 13, 0, 2 * Math.PI, false);
        ctx.fill();
        ctx.stroke();
        ctx.setTransform(1, 0, 0, 1, 0, 0);
    }

    var previous = 0;
    function draw(now) {
        var delta = now - previous;
        ctx.clearRect(0, 0, c.width, c.height);
        drawTank (tank1, delta);
        drawTank (tank2, delta);
        previous = now;
        requestAnimationFrame(draw);
    }

    requestAnimationFrame(draw);

    document.addEventListener('keydown', keyDown);
    document.addEventListener('keyup', keyUp);

    function keyDown(e) {
        if (e.repeat) {
            return;
        }
        if (e.key == 'a') {
            tank1.rotate = "anticlock";
        }
        if (e.key == 'd') {
            tank1.rotate = "clock";
        }
        if (e.key == 'w') {
            tank1.speed = VELOCITY;
        }
        if (e.key == 's') {
            tank1.speed = -VELOCITY_BACK;
        }
        if (e.key == 'ArrowLeft') {
            tank2.rotate = "anticlock";
        }
        if (e.key == 'ArrowRight') {
            tank2.rotate = "clock";
        }
        if (e.key == 'ArrowUp') {
            tank2.speed = VELOCITY;
        }
        if (e.key == 'ArrowDown') {
            tank2.speed = -VELOCITY_BACK;
        }
    }

    function keyUp(e) {
        if (e.repeat) {
            return;
        };
        if (e.key == 'w') {
            tank1.speed = 0;
        };
        if (e.key == 's') {
            tank1.speed = 0;
        }
        if (e.key == 'a') {
            tank1.rotate = "none";
        };
        if (e.key == 'd') {
            tank1.rotate = "none";
        };
        if (e.key == 'ArrowUp') {
            tank2.speed = 0;
        };
        if (e.key == 'ArrowDown') {
            tank2.speed = 0;
        }
        if (e.key == 'ArrowLeft') {
            tank2.rotate = "none";
        };
        if (e.key == 'ArrowRight') {
            tank2.rotate = "none";
        };
    };

</script>
</html>
